<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.5.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2017-06-25T04:43:06+00:00</updated><id>http://localhost:4000/</id><title type="html">apples0</title><subtitle>apples0
</subtitle><entry><title type="html">how to generate HD wallet offline using organic entropy</title><link href="http://localhost:4000/bitcoin/2017/06/21/how-to-generate-HD-wallet-offline-using-organic-entropy.html" rel="alternate" type="text/html" title="how to generate HD wallet offline using organic entropy" /><published>2017-06-21T00:00:00+00:00</published><updated>2017-06-21T00:00:00+00:00</updated><id>http://localhost:4000/bitcoin/2017/06/21/how-to-generate-HD-wallet-offline-using-organic-entropy</id><content type="html" xml:base="http://localhost:4000/bitcoin/2017/06/21/how-to-generate-HD-wallet-offline-using-organic-entropy.html">&lt;h2 id=&quot;1-obtain-secure-offline-environment&quot;&gt;1. obtain secure offline environment&lt;/h2&gt;

&lt;p&gt;In order to accomplish this, I followed the Setup section of the &lt;a href=&quot;https://glacierprotocol.org&quot;&gt;glacier protocol&lt;/a&gt;. They recommend using two latops in the protocol for maximum security, but I believe only one is fine since we’re not using any computer generated entropy and the machine will always stay offline. The generated extended keys (xpub and xpriv) will also be confirmed with two independent open source software packages, so any manufacturer-placed malware to display false extended keys would have to be extremely sophisticated.&lt;/p&gt;

&lt;h3 id=&quot;a-get-the-required-equipment&quot;&gt;a. get the required equipment&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;netbook with at least 2 usb ports, no ethernet (&lt;a href=&quot;https://www.amazon.com/Dell-Inspiron-Celeron-Processor-Windows/dp/B01H7Q4LG8/ref=sr_1_14?s=pc&amp;amp;ie=UTF8&amp;amp;qid=1471767727&amp;amp;sr=1-14&amp;amp;keywords=inspiron&amp;amp;refinements=p_85%3A2470955011&quot;&gt;I recommend this one&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;3 usb drives, at least 2GB (&lt;a href=&quot;https://www.amazon.com/SanDisk-Cruzer-Frustration-Free-Packaging-SDCZ36-008G-AFFP2/dp/B00E9W1UKY/ref=sr_1_7?ie=UTF8&amp;amp;qid=1485220606&amp;amp;sr=8-7&amp;amp;keywords=2GB+USB+drive&quot;&gt;I used these ones (8GB)&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;coin&lt;/li&gt;
  &lt;li&gt;dice (4 dies), (buy the &lt;a href=&quot;https://www.amazon.com/Trademark-Poker-Grade-Serialized-Casino/dp/B00157YFJE/ref=sr_1_1?ie=UTF8&amp;amp;qid=1473894884&amp;amp;sr=8-1&amp;amp;keywords=casino+dice&quot;&gt;red ones&lt;/a&gt;, note that the purple ones will NOT work)&lt;/li&gt;
  &lt;li&gt;small screwdriver &lt;a href=&quot;https://www.amazon.com/TEKTON-2977-Phillips-Precision-Screwdriver/dp/B008TM1910/ref=sr_1_2?s=hi&amp;amp;ie=UTF8&amp;amp;qid=1476232469&amp;amp;sr=1-2&amp;amp;keywords=%2300+screwdriver&quot;&gt;(one of these should work)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;electrical tape&lt;/li&gt;
  &lt;li&gt;masking tape&lt;/li&gt;
  &lt;li&gt;marker&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;b-label-your-drives&quot;&gt;b. label your drives&lt;/h3&gt;

&lt;p&gt;Using the masking tape and marker, label the usb drives as “live”, “offline boot” and “offline apps”. In the glacier protocol the “live” drive is named SETUP because that’s all they ever use it for but we’re going to be using this drive again and again, in order to communicate with our offline machine (via QR codes) and broadcast transactions to the network.&lt;/p&gt;

&lt;h3 id=&quot;c-remove-the-netbooks-wireless-card&quot;&gt;c. remove the netbook’s wireless card&lt;/h3&gt;

&lt;p&gt;For this step you will need to take your small screwdriver and open up the netbook. If you’re using the recommended dell netbook (&lt;a href=&quot;https://www.amazon.com/Dell-Inspiron-Celeron-Processor-Windows/dp/B01H7Q4LG8/ref=sr_1_14?s=pc&amp;amp;ie=UTF8&amp;amp;qid=1471767727&amp;amp;sr=1-14&amp;amp;keywords=inspiron&amp;amp;refinements=p_85%3A2470955011&quot;&gt;2016 Dell Inspiron 11.6”&lt;/a&gt;) then you can check out the following resources on how to do this:&lt;/p&gt;

&lt;p&gt;- &lt;a href=&quot;https://www.youtube.com/watch?v=nFYXQQPoh90&quot;&gt;video&lt;/a&gt; (if link is down then check &lt;a href=&quot;https://github.com/apples0/blog/raw/master/removing_wireless_card_nFYXQQPoh90.mp4&quot;&gt;here&lt;/a&gt;)&lt;br /&gt;
- &lt;a href=&quot;https://github.com/apples0/blog/blob/master/dell_manual.pdf&quot;&gt;manual&lt;/a&gt; (look at the “Removing the wireless card” section)&lt;/p&gt;

&lt;p&gt;After removing the card, use the electrical tape to wrap up the exposed terminal leads. You’ll notice they make you remove the battery before removing the card, I think this is to prevent damage to the circuitry when pulling the card out.&lt;/p&gt;

&lt;h3 id=&quot;d-create-the-live-drive&quot;&gt;d. create the “live” drive&lt;/h3&gt;

&lt;p&gt;This step assumes that you’re using a macbook for your regular computer, if that’s not the case then take a look at the Setup section of the &lt;a href=&quot;https://github.com/apples0/blog/blob/master/Glacier.pdf&quot;&gt;glacier protocol&lt;/a&gt; to learn how to do this.&lt;/p&gt;

&lt;p&gt;- download ubuntu &lt;a href=&quot;http://releases.ubuntu.com/xenial/ubuntu-16.04.2-desktop-amd64.iso&quot;&gt;http://releases.ubuntu.com/xenial/ubuntu-16.04.2-desktop-amd64.iso&lt;/a&gt; *&lt;br /&gt;
- verify its integrity&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;shasum -a 256 ubuntu-16.04.2-desktop-amd64.iso
0f3086aa44edd38531898b32ee3318540af9c643c27346340deb2f9bc1c3de7e  ubuntu-16.04.2-desktop-amd64.iso&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The output should match what’s listed in &lt;a href=&quot;http://releases.ubuntu.com/xenial/SHA256SUMS&quot;&gt;http://releases.ubuntu.com/xenial/SHA256SUMS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;- convert the iso to dmg format&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;hdiutil convert ubuntu-16.04.2-desktop-amd64.iso -format UDRW -o ubuntu-16.04.2-desktop-amd64.img&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;- determine the macOS device identifier for the boot USB&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ diskutil list&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;- plug the “live” usb drive into your regular computer&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ diskutil list &lt;/code&gt;&lt;/p&gt;

&lt;p&gt;You should now see your usb listed as an additional drive that wasn’t there before. The device identifier ​is the part that comes before &lt;code class=&quot;highlighter-rouge&quot;&gt;(external, physical)&lt;/code&gt; ​(for example &lt;code class=&quot;highlighter-rouge&quot;&gt;/dev/disk2&lt;/code&gt;) ​&lt;/p&gt;

&lt;p&gt;- unmount the usb&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ diskutil unmountDisk ​USB-device-identifier-here&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;“​USB-device-identifier-here” will be something like &lt;code class=&quot;highlighter-rouge&quot;&gt;/dev/disk2&lt;/code&gt;, it should be the last one but make sure to check&lt;/p&gt;

&lt;p&gt;- copy dmg to usb drive (&lt;strong&gt;make sure to use the correct device identifier!!&lt;/strong&gt; &lt;em&gt;Using the wrong identifier could overwrite your hard drive&lt;/em&gt;)&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ sudo dd if=ubuntu-16.04.2-desktop-amd64.img.dmg of=​USB-device-identifier-here ​ bs=1m&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;if = input file&lt;br /&gt;
of = output file&lt;br /&gt;
bs = block size&lt;/p&gt;

&lt;p&gt;- click Ignore button&lt;/p&gt;

&lt;p&gt;After the process has completed you’ll get an error saying the disk is not recognized, just click the Ignore button (you just made a drive with a Linux filesystem so it makes sense that your mac doesn’t recognize it)&lt;/p&gt;

&lt;p&gt;* Note that the glacier document shows this as 16.04.1, when I did it this version was not available. Use the latest!&lt;/p&gt;

&lt;h3 id=&quot;e-boot-into-the-live-system&quot;&gt;e. boot into the live system&lt;/h3&gt;

&lt;p&gt;- plug the “live” usb drive into your regular computer&lt;br /&gt;
- restart your regular computer&lt;br /&gt;
- hold down the option key&lt;br /&gt;
- select the live drive, it will probably say “UEFI”. If there are two then it’s probably the last one, if you pick the wrong one don’t cry over your keyboard just try again.&lt;/p&gt;

&lt;p&gt;Note that your screen might flicker and jitter around a bit, that happened to me but it’s not big deal.&lt;/p&gt;

&lt;h3 id=&quot;f-create-the-offline-boot-drive&quot;&gt;f. create the “offline boot” drive&lt;/h3&gt;

&lt;p&gt;- enable networking by clicking on the WIFI cone on the top right and connect to your router/hotspot&lt;br /&gt;
- download ubuntu &lt;a href=&quot;http://releases.ubuntu.com/xenial/ubuntu-16.04.2-desktop-amd64.iso&quot;&gt;http://releases.ubuntu.com/xenial/ubuntu-16.04.2-desktop-amd64.iso&lt;/a&gt;&lt;br /&gt;
- verify its integrity&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sha256sum ubuntu-16.04.2-desktop-amd64.iso
0f3086aa44edd38531898b32ee3318540af9c643c27346340deb2f9bc1c3de7e  ubuntu-16.04.2-desktop-amd64.iso&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Again, the output should match what’s listed in &lt;a href=&quot;http://releases.ubuntu.com/xenial/SHA256SUMS&quot;&gt;http://releases.ubuntu.com/xenial/SHA256SUMS&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;- open the Ubuntu search console by clicking the purple circle/swirl icon in the upper-left corner of the screen&lt;br /&gt;
- type “startup disk”&lt;br /&gt;
- click on Startup Disk Creator icon&lt;br /&gt;
- The “Source disc image” panel should show the .iso file you downloaded. If it doesn’t then click the “Other” button and find it in the folder you downloaded it to.&lt;br /&gt;
- Check out the “Disk to use” field, you’re going to see your usb drive show up in there&lt;br /&gt;
- plug in the “offline boot” usb drive&lt;br /&gt;
- select the “offline boot” drive in the “Disk to use” field&lt;br /&gt;
- click “Make Startup Disk”&lt;/p&gt;

&lt;h3 id=&quot;h-create-the-offline-apps-drive&quot;&gt;h. create the “offline apps” drive&lt;/h3&gt;

&lt;p&gt;You should still be in your live system, but if you’re not then complete &lt;a href=&quot;#e.-boot-into-the-live-system&quot;&gt;section e&lt;/a&gt; again.&lt;/p&gt;

&lt;h1 id=&quot;download-apt-get-dependencies&quot;&gt;download apt-get dependencies&lt;/h1&gt;

&lt;p&gt;- add repositories&lt;/p&gt;

&lt;p&gt;For some reason the live Ubuntu system doesn’t have the normal apt-get repositories added by default, so we need to add them:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-add-repository universe
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get update&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;- download the apps for the offline machine&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get install qrencode zbar-tools python-mnemonic python-qt4 python-pip&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;qrencode&lt;/code&gt; - used to encode QR codes into text&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;zbar-tools&lt;/code&gt; - this library contains the zbarcam command, used to decode QR codes from text&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;python-mnemonic&lt;/code&gt; - used to find the 24th word to satisfy the BIP39 checksum, in the findlastword.py script&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;python-qt4&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;python-pip&lt;/code&gt; - electrum dependencies&lt;/p&gt;

&lt;p&gt;- copy apps to folder&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;mkdir ~/apps
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;cp /var/cache/apt/archives/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;.deb ~/apps&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;download-electrum&quot;&gt;download electrum&lt;/h1&gt;

&lt;p&gt;- download electrum and its signature&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;mkdir ~/electrum
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ~/electrum
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;wget https://download.electrum.org/2.8.3/Electrum-2.8.3.tar.gz
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;wget https://download.electrum.org/2.8.3/Electrum-2.8.3.tar.gz.asc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;strong&gt;verify electrum&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The source tarball should be signed by Thomas Voegtlin of the electrum project, his pgp key is available through &lt;a href=&quot;https://pgp.mit.edu/pks/lookup?op=vindex&amp;amp;search=0x2BD5824B7F9470E6&quot;&gt;this&lt;/a&gt; link on the electrum website. You see this up at the top:&lt;/p&gt;

&lt;p&gt;pub  4096R/&lt;a href=&quot;https://pgp.mit.edu/pks/lookup?op=get&amp;amp;search=0x2BD5824B7F9470E6&quot;&gt;7F9470E6&lt;/a&gt; 2011-06-15&lt;/p&gt;

&lt;p&gt;Click on the 7F9470E6 fingerprint and that will take you to a static page with the pgp public key block, copy everthing from &lt;code class=&quot;highlighter-rouge&quot;&gt;-----BEGIN PGP PUBLIC KEY BLOCK-----&lt;/code&gt; to &lt;code class=&quot;highlighter-rouge&quot;&gt;-----END PGP PUBLIC KEY BLOCK-----&lt;/code&gt; and save it as a file. You can name it &lt;code class=&quot;highlighter-rouge&quot;&gt;electrumpubkey.asc&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;numberonestunna.makethemsayuggghhh&lt;/code&gt; it doesn’t really matter.&lt;/p&gt;

&lt;p&gt;- import gpg public key into your keyring&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ gpg --import electrumpubkey.asc&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;- verify the downloaded source was actually signed by Thomas and not some hacker.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;gpg --verify Electrum-2.8.3.tar.gz.asc Electrum-2.8.3.tar.gz

gpg: Signature made Mon 29 May 2017 07:33:24 AM UTC using RSA key ID 7F9470E6
gpg: Good signature from &lt;span class=&quot;s2&quot;&gt;&quot;Thomas Voegtlin (https://electrum.org) &amp;lt;thomasv@electrum.org&amp;gt;&quot;&lt;/span&gt;
gpg:                 aka &lt;span class=&quot;s2&quot;&gt;&quot;ThomasV &amp;lt;thomasv1@gmx.de&amp;gt;&quot;&lt;/span&gt;
gpg:                 aka &lt;span class=&quot;s2&quot;&gt;&quot;Thomas Voegtlin &amp;lt;thomasv1@gmx.de&amp;gt;&quot;&lt;/span&gt;
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: 6694 D8DE 7BE8 EE56 31BE  D950 2BD5 824B 7F94 70E6&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;- the important thing is that you see “Good signature from “Thomas Voegtlin (https://electrum.org) &amp;lt;thomasv@electrum.org&amp;gt;”, unless you’re a security nerd you won’t have a web of trust so disregard the scary warning message that appears afterwards.&lt;/p&gt;

&lt;p&gt;- download electrum dependencies using pip installer in download mode&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ sudo pip2 install --download ~/electrum ~/electrum/Electrum-2.8.3.tar.gz&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;download-bip39-mnemonic-generator&quot;&gt;download BIP39 mnemonic generator&lt;/h1&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get install git
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;git clone https://github.com/iancoleman/bip39.git&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h1 id=&quot;download-findlastwordpy-script&quot;&gt;download findlastword.py script&lt;/h1&gt;

&lt;p&gt;In order to satisfy the BIP39 checksum, we must choose a suitable last word. We have a simple &lt;a href=&quot;https://github.com/apples0/blog/blob/master/findlastword.py&quot;&gt;script&lt;/a&gt; to accomplish this, thanks to reddit user Morveus in &lt;a href=&quot;https://www.reddit.com/r/crypto/comments/684zvj/need_help_generating_lastword_checksum_for_bip39/dgvq3ca/&quot;&gt;this thread&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ wget https://raw.githubusercontent.com/apples0/blog/master/findlastword.py&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;copy-all-of-this-junk-to-the-offline-apps-usb&quot;&gt;copy all of this junk to the offline apps usb&lt;/h1&gt;

&lt;p&gt;you should now have the folders &lt;code class=&quot;highlighter-rouge&quot;&gt;apps&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;electrum&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;bip39&lt;/code&gt; and the file findlastword.py in the offline apps drive&lt;/p&gt;

&lt;h2 id=&quot;i-boot-offline-computer&quot;&gt;i. boot offline computer&lt;/h2&gt;

&lt;p&gt;- plug in the “offline boot” into your offline computer&lt;br /&gt;
- power it on and repeatedly press F2 until you enter BIOS setup&lt;br /&gt;
- in the BIOS, disable “Fast Boot” and “Secure Boot”&lt;br /&gt;
- click “File Browser Add Boot Option”&lt;br /&gt;
- click on the USB drive and keep drilling down until you see “grubx64.efi” and the click on it&lt;br /&gt;
- now disable the “Windows Boot Manager” option&lt;br /&gt;
- click F10 to save and exit&lt;/p&gt;

&lt;p&gt;You should now boot into the grub menu, in order for the dell to boot you have to adjust the boot commands.&lt;/p&gt;

&lt;p&gt;- press “e” to edit the boot commands&lt;br /&gt;
- delete “quiet splash”&lt;br /&gt;
- in its place, add “nomodeset=0”&lt;br /&gt;
- click F10 to save and boot&lt;/p&gt;

&lt;p&gt;You should now successfully boot into the Ubuntu system. If the above steps don’t work for you then just use google and play around with the BIOS settings until it works.&lt;/p&gt;

&lt;h2 id=&quot;j-install-apps&quot;&gt;j. install apps&lt;/h2&gt;

&lt;p&gt;- plug in “offline apps” drive&lt;br /&gt;
- copy everything on the drive to your home folder&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;install the apt-get packages&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ sudo dpkg -i ~/apps/*.deb&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;install electrum&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ sudo pip2 install --no-index --find-links ~/electrum/ ~/electrum/Electrum-2.8.3.tar.gz&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Congratulations, now you have a secure offline environment where you can generate your master public key and sign transactions.&lt;/p&gt;

&lt;h2 id=&quot;2-generating-mnemonic-words-using-organic-entropy&quot;&gt;2. generating mnemonic words using organic entropy&lt;/h2&gt;

&lt;p&gt;If you have already been using a 12 word seed, use these words as your first 12 words (see &lt;a href=&quot;#plausible-deniability&quot;&gt;Plausible Deniability&lt;/a&gt; section).&lt;/p&gt;

&lt;h3 id=&quot;a-flip-that-coin-roll-some-dice&quot;&gt;a. flip that coin, roll some dice&lt;/h3&gt;

&lt;p&gt;In this section we will be using the coin and the dice to generate the seed words. We will be using this awesome &lt;a href=&quot;https://github.com/apples0/blog/blob/master/bip39-diceware.pdf&quot;&gt;pdf&lt;/a&gt; from &lt;a href=&quot;https://github.com/taelfrinn/Bip39-diceware&quot;&gt;https://github.com/taelfrinn/Bip39-diceware&lt;/a&gt; thanks to github user taelfrinn. We’re rolling 4 dies because it can produce 1296 different permutations (6^4=1296), and this is a little more than half of 2048. To cover the remaining words we flip a coin and have dice rolls with heads represent the first 1296 words and dice rolls with tails cover the remaining. Because there are more combinations than we need (2*1296&amp;gt;2048), we simply ignore dice rolls with tails that are above 4362. Although to be honest, when I rolled over that number I would just reverse the way I read off the numbers so T4672 would turn into T2764. Besides this case, it’s important to always read the numbers in a consistent way.&lt;/p&gt;

&lt;p&gt;- flip a coin&lt;br /&gt;
- roll the dice&lt;br /&gt;
- record the word&lt;/p&gt;

&lt;p&gt;- repeat the above steps until you have recorded 23 words&lt;/p&gt;

&lt;h3 id=&quot;b-find-the-24th-word&quot;&gt;b. find the 24th word&lt;/h3&gt;

&lt;p&gt;In order for our words to be fully BIP39 compatible, the checksum must be satisfied. We can use the &lt;a href=&quot;https://github.com/apples0/blog/blob/master/findlastword.py&quot;&gt;findlastword.py&lt;/a&gt; script to do this. Input your 23 words and then run the following command:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ python findlastword.py&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;There are a handful of candidate words, the way I picked it was to flip a coin and rolled a die. Heads would mean I would start from the top and tails would mean I would start from bottom, I would then select the word corresponding to what I rolled. So if I flipped a tails and rolled a two then I would select the second to last word. Or you can just pick one.&lt;/p&gt;

&lt;h3 id=&quot;c-think-of-a-password&quot;&gt;c. think of a password&lt;/h3&gt;

&lt;p&gt;Think of an easy to remember password that isn’t written down anywhere or associated with you online.&lt;/p&gt;

&lt;p&gt;Now you should have 24 words and a password.&lt;/p&gt;

&lt;h2 id=&quot;3-storing-your-mnemonic-words-and-password&quot;&gt;3. storing your mnemonic words and password&lt;/h2&gt;

&lt;p align=&quot;center&quot;&gt;
  &lt;img src=&quot;https://github.com/apples0/blog/raw/master/figure.png&quot; alt=&quot;figure&quot; /&gt;
&lt;/p&gt;

&lt;h3 id=&quot;a-offline-storage&quot;&gt;a. offline storage&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Store the first 12 words offline, in multiple locations.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;It’s important to write the words down on paper instead of using something like a thumb drive or a QR code, the idea is to make it as difficult and annoying as possible to convert this into a digital form that could then be transmitted on the internet. I’ve just been writing them down on paper and putting them in different places (my house, my car, my friend’s house, my desk at work, my dad’s house) for a good amount of redundancy, but if you have a creative idea please let me know in the comments! I’m not using any of these right now but here are a few ideas I came up with:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;writing the words on the inside of a book&lt;/li&gt;
  &lt;li&gt;circling and indexing words in a dictionary&lt;/li&gt;
  &lt;li&gt;laminating 3 pieces of paper together with the words written on the middle sheet, maybe the outside sheets would be a painting or a picture&lt;/li&gt;
  &lt;li&gt;writing the words in UV light on the inside of a closet or some other weird location&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;b-online-storage&quot;&gt;b. online storage&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Store the second 12 words online, in multiple locations.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;These words can be emailed to yourself, put on cloud storage, stored in a private repo, ftp, whatever. An important additional step which I like to do, is to hide these words in an image using the program steghide. If you’re familiar with command line programs then you’ll find it really easy to use. Here is a &lt;a href=&quot;https://www.youtube.com/watch?v=pW4BQK0LvJo&quot;&gt;great tutorial&lt;/a&gt;, if the link is down then click &lt;a href=&quot;https://github.com/apples0/blog/raw/master/steghide.mp4&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&quot;c-mindgrapes-storage&quot;&gt;c. mindgrapes storage&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;Store the password in your head&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Remember your password as if your entire bank account depended on it.&lt;/p&gt;

&lt;h2 id=&quot;4-generating-hd-wallet&quot;&gt;4. generating HD wallet&lt;/h2&gt;

&lt;p&gt;In your offline computer, open the bip39-standalone.html file and input your 24 words into the “BIP39 Mnemonic” field and your password into the “BIP39 Passphrase” field. Now scroll down and you’ll see two sets of extended keys, the BIP32 Extended Keys are the ones representing the very root so they are the master ones. However in practice you won’t actually use these, you’ll use the Account Extended Keys to dynamically generate public addresses without requiring the private key and these are derived from the BIP32 Extended Keys. Now that you see the extended keys and the generated addresses down at the bottom you can input your words into Electrum and compare the values.&lt;/p&gt;

&lt;p&gt;Open Electrum and do “Standard Wallet -&amp;gt; I already have a seed” and then click the Options button and make sure that the checkboxed “Extend this seed with custom words” and “BIP39 seed” are both checked. If Electrum crashes at any point just open it up again, this happens every now and again and it’s no big deal. Now that your wallet is created you can check to see if your keys match. Open up a terminal (Ctrl-Alt-T in Ubuntu) and type the following command:&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;$ cat ~/.electrum/wallets/default_wallet&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;You should see your xprv and xpub keys in plaintext down at the bottom. Make sure these keys match what you get from the bip39-standalone.html file! If they don’t match then you’re either mistakenly reading from the BIP39 Extended Keys instead of the Account Extended Keys or something is horribly, horribly wrong.&lt;/p&gt;

&lt;h2 id=&quot;5-receiving-btc&quot;&gt;5. receiving btc&lt;/h2&gt;

&lt;p&gt;In Electrum in your offline computer, go to “Wallet -&amp;gt; Master Public Keys” and now you can use this xpub extended key to generate receiving addresses. You can even click on the little QR code icon on the bottom right of the dialog to reveal a QR code. You can then maximize this window and read the code off with your phone’s camera. I know that the MyCelium and Electrum android apps allow you to import this address, and then you can receive BTC and monitor your account without needing to put any of the private keys on the hot device. However keep in mind that the Master Public Key is still considered a sensitive piece of information that you shouldn’t go sharing around everywhere, because it allows anyone to see how much unspent BTC you control and which receiving addresses and transactions are linked to you.&lt;/p&gt;

&lt;h2 id=&quot;6-sending-btc&quot;&gt;6. sending btc&lt;/h2&gt;

&lt;p&gt;Sending BTC is a more involved process. We will be using our regular computer booted off the “live” usb to create a transaction, then we will read this transaction onto our offline computer through a QR code, sign the transaction, and then transfer the signed transaction back to our live computer using another QR code. A high-level summary of the steps are shown below:&lt;/p&gt;

&lt;p&gt;a. boot online computer off “live” usb drive
b. boot offline computer off “offline boot” usb drive
c. transfer master public key to online computer
d. create unsigned transaction on the online computer
e. transfer unsigned transaction to offline computer
f. sign transaction
g. transfer signed transaction to the online computer
h. broadcast transaction&lt;/p&gt;

&lt;p&gt;Here we go!&lt;/p&gt;

&lt;h3 id=&quot;a-boot-online-computer-off-live-usb-drive&quot;&gt;a. boot online computer off “live” usb drive**&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-add-repository universe
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get update
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get install qrencode zbar-tools steghide python-pip python-qt4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;- follow &lt;a href=&quot;#download-electrum&quot;&gt;download electrum&lt;/a&gt; step to download, verify and install electrum&lt;/p&gt;

&lt;p&gt;Unfortunately the macbook camera (called facetimehd) does not work in Linux, however thankfully github user patjak came up with a solution outlined &lt;a href=&quot;https://github.com/patjak/bcwc_pcie/wiki/Get-Started&quot;&gt;here&lt;/a&gt;. Using these instructions I created this &lt;a href=&quot;https://github.com/apples0/blog/blob/master/enable_facetimehd_camera.sh&quot;&gt;script&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-add-repository universe
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo apt-get update
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;wget https://github.com/apples0/blog/raw/master/enable_facetimehd_camera.sh
&lt;span class=&quot;gp&quot;&gt;$ &lt;/span&gt;sudo bash enable_facetimehd_camera.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To test that the above works, type the command &lt;code class=&quot;highlighter-rouge&quot;&gt;$ zbarcam&lt;/code&gt;, if everything worked out then you should see a dialog pop up showing the camera output.&lt;/p&gt;

&lt;h3 id=&quot;b-boot-offline-computer-off-offline-boot-usb-drive&quot;&gt;b. boot offline computer off “offline boot” usb drive**&lt;/h3&gt;

&lt;p&gt;- copy apps and electrum folders to home directory&lt;br /&gt;
- install apps and electrum as in the &lt;a href=&quot;#install-apps&quot;&gt;install apps&lt;/a&gt; section&lt;/p&gt;

&lt;h3 id=&quot;c-transfer-master-public-key-to-online-computer&quot;&gt;c. transfer master public key to online computer&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;on the online computer:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;- open Electrum&lt;br /&gt;
- Standard Wallet -&amp;gt; Use public or private keys&lt;br /&gt;
- click on QR code icon&lt;/p&gt;

&lt;p&gt;The camera should appear, now you’re ready to receive the master public key as a QR code.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;on the offline computer:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;- open Electrum&lt;br /&gt;
- Standard Wallet -&amp;gt; I already have a seed&lt;br /&gt;
- Wallet -&amp;gt; Master Public Keys (Electrum sometimes crashes here, just start it up again and try again)&lt;br /&gt;
- Click the QR code icon&lt;/p&gt;

&lt;p&gt;Now maximize the dialog to make the QR code take up the whole screen and then hold your offline computer screen to your online computer camera to scan the code. Now you should have a “watching wallet” on your online computer.&lt;/p&gt;

&lt;h3 id=&quot;d-create-unsigned-transaction-on-the-online-computer&quot;&gt;d. create unsigned transaction on the online computer&lt;/h3&gt;

&lt;p&gt;- go to the Send tab and enter the receiving address in the Pay to field and the Amount in mBTC.&lt;br /&gt;
- click the Preview button&lt;br /&gt;
- on the dialog that pops up, click the QR code button and maximize the resulting dialog so it’s easier to scan&lt;/p&gt;

&lt;h3 id=&quot;e-transfer-unsigned-transaction-to-offline-computer&quot;&gt;e. transfer unsigned transaction to offline computer&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;on the offline computer:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;- Tools -&amp;gt; Load Transaction -&amp;gt; From QR code&lt;/p&gt;

&lt;p&gt;Now hold your offline computer camera to the online computer screen and read the QR code&lt;/p&gt;

&lt;h3 id=&quot;f-sign-transaction&quot;&gt;f. sign transaction&lt;/h3&gt;

&lt;p&gt;- make sure everything looks good&lt;br /&gt;
- click the Sign button&lt;/p&gt;

&lt;h3 id=&quot;g-transfer-signed-transaction-to-the-online-computer&quot;&gt;g. transfer signed transaction to the online computer&lt;/h3&gt;

&lt;p&gt;- after hitting the Sign button, click the QR code icon and maximize it&lt;/p&gt;

&lt;p&gt;&lt;em&gt;on the online computer:&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;- Tools -&amp;gt; Load Transaction -&amp;gt; From QR code&lt;/p&gt;

&lt;p&gt;Now hold your offline computer screen up to your online computer camera&lt;/p&gt;

&lt;h3 id=&quot;h-broadcast-to-the-network&quot;&gt;h. broadcast to the network&lt;/h3&gt;

&lt;p&gt;click the Broadcast button, it should say something like “Payment sent” and show the Transaction ID&lt;/p&gt;

&lt;h2 id=&quot;additional-notes&quot;&gt;additional notes&lt;/h2&gt;

&lt;h3 id=&quot;plausible-deniability&quot;&gt;plausible deniability&lt;/h3&gt;

&lt;p&gt;If you have already been using a 12 word seed, then you can use those 12 words as the words you store in multiple locations offline. By transferring its funds to your new wallet you will have real plausible deniability because there will be significant transaction history with those words. The offline words are also the most likely to be found by someone who would want to hit you with a wrench.&lt;/p&gt;

&lt;p&gt;You might also want to transfer your existing bitcoin to your new wallet incrementally over time to make the history seem more realistic, like you were selling them off to people on localbitcoins.com or something. One large transaction probably looks more like you just transferred it to a new wallet.&lt;/p&gt;</content><author><name></name></author><summary type="html">1. obtain secure offline environment</summary></entry></feed>